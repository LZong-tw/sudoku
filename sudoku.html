<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sudoku</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #1a1a2e; color: #eee; min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        h1 { color: #4ecca3; margin-bottom: 20px; }
        .container { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; align-items: flex-start; }
        #info { background: #16213e; padding: 15px; border-radius: 10px; min-width: 200px; }
        #info div { margin: 10px 0; display: flex; justify-content: space-between; }
        #info span:last-child { color: #4ecca3; font-weight: bold; }
        #grid { display: grid; grid-template-columns: repeat(9, 1fr); gap: 2px; background: #0f3460; padding: 3px; border-radius: 10px; width: min(90vw, 400px); aspect-ratio: 1; }
        .cell { background: #16213e; display: flex; align-items: center; justify-content: center; font-size: clamp(16px, 5vw, 24px); cursor: pointer; transition: all 0.15s; user-select: none; }
        .cell:nth-child(3n) { border-right: 2px solid #0f3460; }
        .cell:nth-child(n+19):nth-child(-n+27), .cell:nth-child(n+46):nth-child(-n+54) { border-bottom: 2px solid #0f3460; }
        .cell.selected { background: #4ecca3; color: #1a1a2e; transform: scale(1.05); }
        .cell.highlight { background: #233554; }
        .cell.fixed { color: #888; }
        .cell.valid { animation: pop 0.2s; }
        .cell.invalid { background: #e94560; animation: shake 0.3s; }
        .cell.complete { background: #2d6a4f; }
        @keyframes pop { 50% { transform: scale(1.2); } }
        @keyframes shake { 25%, 75% { transform: translateX(-3px); } 50% { transform: translateX(3px); } }
        .buttons { margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
        button { background: #4ecca3; color: #1a1a2e; border: none; padding: 12px 24px; border-radius: 8px; font-size: 16px; cursor: pointer; transition: transform 0.1s, opacity 0.1s; }
        button:hover { opacity: 0.9; transform: translateY(-2px); }
        select { background: #16213e; color: #eee; border: 1px solid #4ecca3; padding: 12px; border-radius: 8px; font-size: 16px; }
        .numpad { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; margin-top: 15px; }
        .numpad button { padding: 15px; }
    </style>
</head>
<body>
    <h1>Sudoku</h1>
    <div class="container">
        <div id="info">
            <div><span>Difficulty</span><span id="difficulty">Easy</span></div>
            <div><span>Time</span><span id="timer">00:00</span></div>
            <div><span>Mistakes</span><span id="mistakes">0</span></div>
            <div><span>Progress</span><span id="progress">0%</span></div>
        </div>
        <div id="grid"></div>
    </div>
    <div class="buttons">
        <select id="diffSelect"><option>Easy</option><option>Medium</option><option>Hard</option></select>
        <button onclick="newGame()">New Game</button>
        <button onclick="checkSolution()">Check</button>
    </div>
    <div class="numpad">
        <button onclick="enterNum(1)">1</button><button onclick="enterNum(2)">2</button><button onclick="enterNum(3)">3</button><button onclick="enterNum(4)">4</button><button onclick="enterNum(5)">5</button>
        <button onclick="enterNum(6)">6</button><button onclick="enterNum(7)">7</button><button onclick="enterNum(8)">8</button><button onclick="enterNum(9)">9</button><button onclick="enterNum(0)">âŒ«</button>
    </div>
    <script>
        const puzzles = {
            Easy: ['53..7....6..195....98....6.8...6...34..8.3..17...2...6.6....28....419..5....8..79'],
            Medium: ['..3.2.6..9..3.5..1..18.64....81.29..7.......8..67.82....26.95..8..2.3..9..5.1.3..'],
            Hard: ['4.....8.5.3..........7......2.....6.....8.4......1.......6.3.7.5..2.....1.4......']
        };
        let solution = [], selected = -1, mistakes = 0, seconds = 0, timerInterval;

        function createGrid() {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            for (let i = 0; i < 81; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.dataset.index = i;
                cell.onclick = () => selectCell(i);
                grid.appendChild(cell);
            }
        }

        function selectCell(i) {
            document.querySelectorAll('.cell').forEach((c, idx) => {
                c.classList.remove('selected', 'highlight');
                if (!c.classList.contains('fixed') && idx === i) c.classList.add('selected');
                else if (Math.floor(idx / 9) === Math.floor(i / 9) || idx % 9 === i % 9 || 
                    (Math.floor(idx / 27) === Math.floor(i / 27) && Math.floor((idx % 9) / 3) === Math.floor((i % 9) / 3)))
                    c.classList.add('highlight');
            });
            selected = i;
        }

        function enterNum(n) {
            if (selected < 0) return;
            const cell = document.querySelector(`[data-index="${selected}"]`);
            if (cell.classList.contains('fixed')) return;
            
            cell.textContent = n || '';
            cell.classList.remove('valid', 'invalid');
            
            if (n && n.toString() !== solution[selected]) {
                cell.classList.add('invalid');
                document.getElementById('mistakes').textContent = ++mistakes;
            } else if (n) {
                cell.classList.add('valid');
            }
            updateProgress();
            checkComplete();
        }

        function newGame() {
            const diff = document.getElementById('diffSelect').value;
            document.getElementById('difficulty').textContent = diff;
            const puzzle = puzzles[diff][Math.floor(Math.random() * puzzles[diff].length)];
            solution = solveSudoku(puzzle);
            
            document.querySelectorAll('.cell').forEach((cell, i) => {
                cell.className = 'cell';
                cell.textContent = puzzle[i] !== '.' ? puzzle[i] : '';
                if (puzzle[i] !== '.') cell.classList.add('fixed');
            });
            
            mistakes = 0; seconds = 0; selected = -1;
            document.getElementById('mistakes').textContent = '0';
            document.getElementById('timer').textContent = '00:00';
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                seconds++;
                document.getElementById('timer').textContent = 
                    `${String(Math.floor(seconds / 60)).padStart(2, '0')}:${String(seconds % 60).padStart(2, '0')}`;
            }, 1000);
            updateProgress();
        }

        function updateProgress() {
            const filled = [...document.querySelectorAll('.cell')].filter(c => c.textContent).length;
            document.getElementById('progress').textContent = Math.round(filled / 81 * 100) + '%';
        }

        function checkComplete() {
            const cells = document.querySelectorAll('.cell');
            const current = [...cells].map(c => c.textContent || '.');
            if (!current.includes('.') && current.join('') === solution.join('')) {
                clearInterval(timerInterval);
                cells.forEach(c => c.classList.add('complete'));
                setTimeout(() => alert('Congratulations! Puzzle solved!'), 300);
            }
        }

        function checkSolution() {
            const cells = document.querySelectorAll('.cell');
            cells.forEach((cell, i) => {
                if (!cell.classList.contains('fixed') && cell.textContent) {
                    cell.classList.remove('valid', 'invalid');
                    cell.classList.add(cell.textContent === solution[i] ? 'valid' : 'invalid');
                }
            });
        }

        function solveSudoku(puzzle) {
            const board = puzzle.split('');
            (function solve() {
                const e = board.indexOf('.');
                if (e < 0) return true;
                for (let n = 1; n <= 9; n++) {
                    const s = n.toString(), r = Math.floor(e / 9), c = e % 9;
                    const br = Math.floor(r / 3) * 3, bc = Math.floor(c / 3) * 3;
                    let valid = true;
                    for (let i = 0; i < 9 && valid; i++) {
                        if (board[r * 9 + i] === s || board[i * 9 + c] === s) valid = false;
                        if (board[(br + Math.floor(i / 3)) * 9 + bc + i % 3] === s) valid = false;
                    }
                    if (valid) { board[e] = s; if (solve()) return true; board[e] = '.'; }
                }
                return false;
            })();
            return board;
        }

        document.addEventListener('keydown', e => {
            if (e.key >= '1' && e.key <= '9') enterNum(parseInt(e.key));
            else if (e.key === 'Backspace' || e.key === 'Delete' || e.key === '0') enterNum(0);
            else if (e.key.startsWith('Arrow')) {
                const dir = { ArrowUp: -9, ArrowDown: 9, ArrowLeft: -1, ArrowRight: 1 };
                const next = selected + (dir[e.key] || 0);
                if (next >= 0 && next < 81 && !(e.key === 'ArrowLeft' && selected % 9 === 0) && !(e.key === 'ArrowRight' && selected % 9 === 8))
                    selectCell(next);
            }
        });

        createGrid();
        newGame();
    </script>
</body>
</html>
